This Course will be focused on:
    - Window Function
    - Statistical Function
    - Approximation Function


#### Advanced Function (Statistical, Analytics, and user-defined)

Statistical function example:
    SELECT
        STDDEV(noemployeesw3cnt) AS st_dev_employee_count,
        CORR(totprgmrevenue, totfuncexpns) AS corr_rev_expensses
    FROM
        ''

    ## STDDEV - Standard Deviation
    ## CORR - Correlation [in example above, how correlated the program revenue with total functional expenses]

## RANK() Advanced function, for Aggregating over groups of rows

SELECT firstname, departement, startdate
    RANK() OVER ( PARTITION BY departement ORDER BY startdate ) AS rank
FROM employees

## BigQuery User Defined Function(s) - UDFs

CREATE FUNCTION d2i_demo.nlp_compromise_people(str STRING)
    RETURN ARRAY<STRING> LANGUAGE js AS '''
        return nlp(str).people().out('topk').map(x => x.normal)
    '''
    OPTION(
        library="gs://cloud-training/datatoinsights/assets/compromise.min.11.14.0.js"
    );

SELECT name, COUNT(*) c
FROM (
    SELECT d2i_demo.nlp_compromise_people(title) as names
    FROM `d2i_demo.reddit_post`
    WHERE subreddit = 'movies'
), UNNEST(names) name

WHERE name LIKE '% %' GROUP BY 1
ORDER BY 2 DESC LIMIT 10

